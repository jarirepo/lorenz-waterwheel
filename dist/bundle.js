!function(t){function s(i){if(e[i])return e[i].exports;var h=e[i]={i:i,l:!1,exports:{}};return t[i].call(h.exports,h,h.exports,s),h.l=!0,h.exports}var e={};s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},s.p="",s(s.s=1)}([function(t,s,e){"use strict";const{PI:i,random:h}=Math,r=2*i;s.a=class{constructor(t,s){this.density=.1,this.volume=.1,this.mass=this.density*this.volume,this.pos0={x:t,y:s},this.pos={x:t,y:s},this.vel={x:0,y:0},this.acc={x:0,y:0},this.force={x:0,y:0},this.stuck=!1}reset(){this.pos.x=this.pos0.x,this.pos.y=this.pos0.y,this.vel.x=0,this.vel.y=0,this.acc.x=0,this.acc.y=0,this.force.x=0,this.force.y=0,this.stuck=!1}applyForce(t,s){this.force.x+=t,this.force.y+=s}update(t){this.acc.x=this.force.x/this.mass,this.acc.y=this.force.y/this.mass,this.pos.x+=this.vel.x*t+this.acc.x*t*t/2,this.pos.y+=this.vel.y*t+this.acc.y*t*t/2,this.vel.x+=this.acc.x*t,this.vel.y+=this.acc.y*t,this.force.x=0,this.force.y=0}render(t){this.stuck||(t.beginPath(),t.fillStyle="rgba(0,0,255,1.0)",t.arc(this.pos.x,this.pos.y,2,0,r),t.fill())}}},function(t,s,e){"use strict";function i(t=0){if(o.fillStyle="#000",o.fillRect(0,0,r.width,r.height),t>0){for(n+=t-l;n>=10;)n-=10,c+=10,a.update();if(u.length<p?u.push({t:c,value:a.wheel.omega}):u.splice(0,1),a.render(o),a.started&&u.length>1){const t=u[0].t;o.setTransform(1,0,0,-1,10,r.height/2),o.beginPath(),o.lineWidth=2,o.strokeStyle="rgba(0,255,200,0.5)",o.moveTo(0,40*u[0].value);for(let s=1;s<u.length;s++)o.lineTo((u[s].t-t)/50,40*u[s].value);o.stroke(),o.setTransform(1,0,0,1,0,0)}}l=t,requestAnimationFrame(i)}Object.defineProperty(s,"__esModule",{value:!0});var h=e(2);const r=document.getElementById("simulation"),o=r.getContext("2d");o.globalAlpha=.8;const a=new h.a({canvas:r,timestep:.01,gravity:200,x:r.width/2,y:r.height/2,wheelRadius:150,momentOfInertia:150,numBuckets:11,dropletPeriod:1e3,numDroplets:50,bucketRadius:15,bucketHeight:30,bucketCapacity:10});let l,n=0,c=0,u=[];const p=1e3;window.onload=(()=>{document.getElementById("start").addEventListener("click",()=>{a.start()})}),i()},function(t,s,e){"use strict";var i=e(3),h=e(0);const{cos:r,PI:o,pow:a,random:l,sin:n,sqrt:c}=Math;s.a=class{constructor(t){this.options=t,this.wheel=new i.a(t),this.started=!1,this._timer=null,this.droplets=new Array,this.data=new Array}start(){this.started||(this.started=!0,this._timer=setInterval(()=>{if(this.droplets.length<this.options.numDroplets){const t=this.options.canvas.width/2-10+20*l();this.droplets.push(new h.a(t,0))}},this.options.dropletPeriod))}update(){if(this.started){this.droplets.forEach(t=>{t.stuck||(t.applyForce(0,t.mass*this.options.gravity),t.update(this.options.timestep),this.wheel.buckets.forEach(s=>{t.pos.x>s.x-s.radius&&t.pos.x<s.x+s.radius&&t.pos.y>s.y-s.height/2&&t.pos.y<s.y+s.height/2&&(s.level>0?t.pos.y>s.y+s.height/2-s.level&&s.addDroplet(t):s.addDroplet(t))}))}),this.wheel.buckets.forEach(t=>{if(t.droplets.length>0){let s=!1;if(t.isFull())s=!0;else{const e=.1*t.droplets.length/t.capacity;s=l()<e}if(s){const s=t.removeDroplet();s.pos.x=t.x-5+10*l(),s.pos.y=t.y+t.height/2+1,s.vel.x=0,s.vel.y=0,s.stuck=!1}}if(t.droplets.length>1){const s=t.droplets.reduce((t,s)=>s.mass)*this.options.gravity*(this.wheel.radius*r(this.wheel.theta+t.theta));this.wheel.applyTorque(s)}}),this.wheel.update(this.options.timestep);for(let t=this.droplets.length-1;t>=0;t--){const s=this.droplets[t];s.stuck||(s.pos.x<0||s.pos.x>this.options.canvas.width||s.pos.y<0||s.pos.y>this.options.canvas.height)&&s.reset()}}}render(t){this.wheel.render(t),this.droplets.forEach(s=>s.render(t))}}},function(t,s,e){"use strict";var i=e(4);const{PI:h}=Math,r=2*h;s.a=class{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.wheelRadius,this.momentOfInertia=t.momentOfInertia,this.numBuckets=t.numBuckets,this.theta=0,this.omega=0,this.alpha=0,this.torque=0,this.buckets=new Array,this._createBuckets(t)}applyTorque(t){this.torque+=t}update(t){this.alpha=this.torque/this.momentOfInertia,this.theta+=this.omega*t+this.alpha*t*t/2,this.omega+=this.alpha*t,this.torque=0,this.buckets.forEach(t=>t.update())}render(t){t.beginPath(),t.fillStyle="#333",t.arc(this.x,this.y,10,0,r),t.fill(),t.beginPath(),t.strokeStyle="#333",t.lineWidth=2,t.arc(this.x,this.y,this.radius,0,r),t.stroke(),this.buckets.forEach(s=>{s.render(t)})}_createBuckets(t){const s=this.numBuckets;for(let e=0;e<s;e++){const o=new i.a(this,t.bucketRadius,t.bucketHeight,t.bucketCapacity,-h/2-h/72+e/s*r);this.buckets.push(o)}}}},function(t,s,e){"use strict";e(0);const{cos:i,sin:h}=Math;s.a=class{constructor(t,s,e,i,h){this.wheel=t,this.theta=h,this.capacity=i,this.droplets=new Array,this.radius=s,this.height=e,this.ang=0,this.x=0,this.y=0,this.level=0,this.update()}update(){this.ang=this.wheel.theta+this.theta,this.x=this.wheel.x+this.wheel.radius*i(this.ang),this.y=this.wheel.y+this.wheel.radius*h(this.ang)}_updateLevel(){const t=this.droplets.length/this.capacity;this.level=t*this.height}addDroplet(t){this.isFull()||(t.stuck=!0,this.droplets.push(t),this._updateLevel())}isFull(){return!(this.droplets.length<this.capacity)}removeDroplet(){const t=this.droplets.pop();return this._updateLevel(),t}render(t){t.setTransform(1,0,0,1,this.x,this.y),t.fillStyle="rgba(0,200,0,0.5)",t.fillRect(-this.radius,-this.height/2,2*this.radius,this.height),this.droplets.length>0&&(t.beginPath(),t.fillStyle="#0000ff",t.rect(-this.radius,this.height/2-this.level,2*this.radius,this.level),t.fill()),t.beginPath(),t.strokeStyle="#00cc00",t.lineWidth=1,t.moveTo(-this.radius-4,-this.height/2),t.lineTo(-this.radius,-this.height/2),t.lineTo(-this.radius,this.height/2),t.lineTo(this.radius,this.height/2),t.lineTo(this.radius,-this.height/2),t.lineTo(this.radius+4,-this.height/2),t.stroke(),t.setTransform(1,0,0,1,0,0)}}}]);